(()=>{var B=document.getElementById("board"),Ne=document.getElementById("status"),$=document.getElementById("score_black"),M=document.getElementById("score_white"),Oe=document.getElementById("turn_display"),pe=document.getElementById("move-list"),ct=document.getElementById("copy-url-btn"),ke=document.getElementById("playerJoin"),se=document.getElementById("warningSound"),b=document.getElementById("victorySound"),C=document.getElementById("defeatSound"),T=new(window.AudioContext||window.webkitAudioContext),j=null,ze=null,Re=0,Me=T.createGain();Me.connect(T.destination);Me.gain.value=.09;var he=null,Ze=!1,Y,rt=document.getElementById("start-match"),ce=document.getElementById("game-settings-overlay"),De=document.getElementById("surrender-btn"),dt=window.location.protocol==="https:"?"wss":"ws",P=localStorage.getItem("playerName");P||(P="player"+Math.floor(Math.random()*1e3),localStorage.setItem("playerName",P));var N=localStorage.getItem("playerId");N||(N=crypto.randomUUID(),localStorage.setItem("playerId",N));var mt=new URLSearchParams(window.location.search),Pe=mt.get("room"),I=null,Q=localStorage.getItem("soundEffects")!=="false",X=localStorage.getItem("timeLimitSoundEnabled")!=="false",_=localStorage.getItem("gameEndSoundEnabled")!=="false",ee=localStorage.getItem("playerJoinSoundEnabled")!=="false",h=localStorage.getItem("showValidMoves")!=="false",u=parseInt(localStorage.getItem("timeLimit")||0),E=parseInt(localStorage.getItem("aiLevel")||1),g="black",y=Array.from({length:8},()=>Array(8).fill("")),w=[],ut=-1,ve=null,V=parseInt(localStorage.getItem("gameFinishedCount")||0),A=E-2,K,q=!1,x="",S=!1,W="ja",m=window.location.pathname.split("/").filter(Boolean)[0]||"player";m==="en"&&(m=window.location.pathname.split("/").filter(Boolean)[1]||"player",W="en");var Ue=!1,O=!1,v=!1,p="unknown",L,te=document.getElementById("result-popup"),Ae=document.getElementById("r-background-overlay"),gt=document.getElementById("result-image"),ft=document.getElementById("score-difference"),we=document.getElementById("r-message"),qe=document.getElementById("r-overlay"),ge=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]];function be(){let e=document.createDocumentFragment();for(let t=0;t<8;t++){let n=document.createElement("div");n.className="row",n.setAttribute("role","row");for(let l=0;l<8;l++){y[t][l]="";let o=document.createElement("div");o.className="cell",o.dataset.row=t,o.dataset.col=l,o.setAttribute("aria-label","abcdefgh"[l]+`${t+1}\uFF1A\u7A7A`),o.setAttribute("role","gridcell"),n.appendChild(o)}e.appendChild(n)}B.appendChild(e)}B.addEventListener("click",e=>{if(!O){let t=e.target.closest(".cell");if(!t)return;let n=parseInt(t.dataset.row,10),l=parseInt(t.dataset.col,10);Xe(n,l)}});function yt(){be(),Et()||Ke(),Le(),J()}function Ke(){G(3,3,"white"),G(3,4,"black"),G(4,3,"black"),G(4,4,"white")}function Le(){[{row:1,col:1},{row:1,col:5},{row:5,col:1},{row:5,col:5}].forEach(({row:t,col:n})=>{let l=B.children[t].children[n],o=document.createElement("div");o.className="marker",l.classList.add("44"),l.appendChild(o)}),document.getElementById("b_loader").style.display="none"}function G(e,t,n){y[e][t]=n;let l=B.children[e].children[t];l.classList.contains("44")?l.innerHTML=`<div class="disc 44 ${n}"></div><div class="marker"></div>`:l.innerHTML=`<div class="disc ${n}"></div>`,l.setAttribute("aria-label","abcdefgh"[t]+`${e+1}\uFF1A${n==="black"?lang.black:lang.white}`)}function Je(e){if(v)if(p===e){alert(lang.you_pass);return}else{alert(lang.opponent_pass);return}alert(e==="black"?lang.notify_b:lang.notify_w)}function pt(){return y.flat().every(e=>e!=="")}async function re(e,t,n,l,o=!1){if(y[e][t]!==""||!Be(e,t,n)){console.warn(`[applyServerMove] Invalid move: (${e},${t}), gameBoard[${e}][${t}]: ${y[e][t]}, isValidMove: ${Be(e,t,n)}`);return}ve&&ve.classList.remove("last-move"),G(e,t,n),Q&&(l!==1?await Ge():o&&(console.log("[applyServerMove]final"+o),Ge()));let i=B.children[e].children[t];i.firstChild.classList.add("last-move"),ve=i.firstChild,ht(e,t,n),vt(e,t,l),!v&&pt()?le("offline"):(g=n==="black"?"white":"black",de(g)||(v?p===g&&o===1&&I.send(JSON.stringify({action:"pass"})):(l!==1&&(l===0||l===1?Je(g):l===2&&alert(lang.you_pass)),O=!1),g=g==="black"?"white":"black",console.log(`[applyServerMove] No valid moves. SO currentP became: ${g}`),de(g)?J():v||le("offline"))),m==="ai"&&g==="white"&&!q&&l!==1&&O===!1?Qe():(o!==!1||!v)&&fe(),(o!==!1||!v)&&J()}function Qe(){O=!0,R();let e=document.getElementById("timer-display");e.classList.remove("warning1","warning2"),e.style.display="inline-block";let t=E===6?"\u{1F424} ":E===9?"\u{1F47A} ":E===7?"\u{1F506} ":"\u{1F914} ";e.textContent=t+lang.thinking,B.classList.add("thinking"),setTimeout(()=>{J(),Lt(),fe()},10)}function Xe(e,t,n=0){if(!q){if(n===1){re(e,t,g,n);return}if(v)if(p==="unknown"){alert(lang.connecting);return}else if(p==="spectator"){alert(lang.spec_cant_play);return}else if(p===g)Rt(e,t);else{let l=p==="black"?lang.black:p==="white"?lang.white:lang.spec;alert(`${lang.not_your_turn}${g==="black"?lang.black:lang.white}, ${lang.you}\uFF1A${l}`);return}else re(e,t,g,n)}}function Be(e,t,n=g){if(y[e][t]!=="")return!1;for(let[l,o]of ge)if(et(e,t,l,o,n))return[e,t];return!1}function et(e,t,n,l,o=g){let i=e+n,a=t+l;if(!H(i,a)||y[i][a]!==Se(o))return!1;for(;H(i,a)&&y[i][a]===Se(o);)i+=n,a+=l;return H(i,a)&&y[i][a]===o}function ht(e,t,n=g){for(let[l,o]of ge)if(et(e,t,l,o,n)){let i=e+l,a=t+o;for(;y[i][a]===Se(n);)G(i,a,n),i+=l,a+=o}}function H(e,t){return e>=0&&e<8&&t>=0&&t<8}function Se(e=g){return e==="black"?"white":"black"}function de(e=g){let t=[];for(let n=0;n<8;n++)for(let l=0;l<8;l++)if(y[n][l]===""){let o=Be(n,l,e);o&&t.push(o)}return t.length>0?t:!1}function tt(){nt();let e=de();e&&e.forEach(([t,n])=>{let l=B.children[t].children[n];l.classList.add("valid-move"),(m==="ai"&&g==="white"||v&&p!==g&&(y.flat().filter(i=>i!=="").length!==4||p==="white"))&&B.classList.add("opponent-turn");let o=document.createElement("div");o.className=`faint-disc faint-${g}`,l.appendChild(o)})}function nt(){document.querySelectorAll(".valid-move").forEach(t=>{let n=t.querySelector(".faint-disc");n&&n.remove(),t.classList.remove("valid-move"),B.classList.remove("opponent-turn")})}function J(){let e=y.flat().filter(n=>n==="black").length,t=y.flat().filter(n=>n==="white").length;if($.textContent=e,M.textContent=t,g==="black"?(Ne.style.backgroundColor="#000",Oe.textContent=lang.black_turn):(Ne.style.backgroundColor="#fff",Oe.textContent=lang.white_turn),h||h==="true"?tt():nt(),!O){let n=document.getElementById("timer-display");u>0?(n.style.display="inline-block",q||lt()):(n.style.display="none",R())}}function lt(){let e=u,t=document.getElementById("timer-display");t.textContent=me(e),t.classList.remove("warning1"),t.classList.remove("warning2"),R(),y.flat().filter(n=>n!=="").length!==4&&(se.currentTime=0,K=setInterval(()=>{e--,t.textContent=me(e),e<4&&X&&se.play().catch(n=>{console.warn("audio was blocked:",n)}),e<=5?(t.classList.remove("warning1"),t.classList.add("warning2")):e<=15?t.classList.add("warning1"):(t.classList.remove("warning1"),t.classList.remove("warning2")),e<=0&&(clearInterval(K),v||(alert(lang.timeout_winner+(g==="black"?lang.white:lang.black)),le("offline",g==="black"?"white":"black")))},1e3))}function R(){K&&(clearInterval(K),K=null,se.pause())}function me(e){let t=Math.floor(e/60),n=e%60;return`${t}:${n<10?"0":""}${n}`}function Ve(){return/iPhone|iPad|iPod/.test(navigator.userAgent)}function vt(e,t,n){let o=`${"abcdefgh"[t]}${e+1}`;n!==1&&(w.push({row:e,col:t,player:g,moveNotation:o,token:"recordMove"}),localStorage.setItem("deleted_urls",JSON.stringify([]))),ut=w.length-1,wt()}function wt(){let e=w.map((t,n)=>`${n+1}. ${t.player==="black"?"\u25CF":"\u25CB"}${t.moveNotation}`);pe.textContent=e.join(`
`),pe.scrollTop=pe.scrollHeight}function It(){return w.map(e=>`${e.player[0]}${e.row}${e.col}`).join("-")}function _e(e){let t=e.split("-");t[t.length-1]===""&&t.pop(),w=[],w=t.map(n=>{let l=parseInt(n[1]),o=parseInt(n[2]),i=n[0]==="b"?"black":"white";return{row:l,col:o,player:i,moveNotation:`${"abcdefgh"[o]}${l+1}`,token:"deserialize"}})}function fe(){let e=It(),t=new URL(window.location),n=`/${m}/`;m==="player"&&(n="/"),window.location.pathname.split("/").filter(Boolean)[0]==="en"&&(n="en"+n),t.pathname=n,t.searchParams.set("moves",e),t.searchParams.set("timeLimit",u),t.searchParams.set("showValidMoves",h),t.searchParams.set("aiLevel",E),history.pushState(null,"",t)}function Et(){let e=new URLSearchParams(window.location.search),t=e.get("moves"),n=e.get("timeLimit"),l=e.get("showValidMoves"),o=window.location.pathname.split("/").filter(Boolean),i=o[0]||"player";if(o[0]==="en"&&(i=o[1]||"player"),!navigator.onLine&&i==="online"){let d=W==="en"?"/en/offline.html":"/offline.html";window.location.href=d;return}let a=e.get("won"),r=e.get("aiLevel");if(a==="won"&&(u=0,R()),i){if(m=i,localStorage.setItem("gameMode",m),document.querySelectorAll(".mode-btn").forEach(d=>{d.classList.remove("active"),d.dataset.mode===m&&d.classList.add("active")}),m==="ai")document.getElementById("level_ai").style.display="block";else{document.getElementById("level_ai").style.display="none";let d=new URL(window.location);d.searchParams.delete("aiLevel"),history.replaceState(null,"",d)}if(m==="online")console.log(`timelimit: ${u}`),qt(),v=!0,it(),document.getElementById("playerJoinSoundBox").style.display="block";else{n&&(u=parseInt(n),u===0?document.getElementById("timeLimitBox_").style.display="none":document.getElementById("timeLimitBox_").style.display="block"),r&&(E=parseInt(r)),l&&(h=l==="true");let d=new URL(window.location);d.searchParams.delete("room"),history.pushState(null,"",d),v=!1,I&&(I.close(),I=null),document.getElementById("playerJoinSoundBox").style.display="none"}}return document.getElementById("timeLimitSelect").value=u,document.getElementById("aiLevelSelect").value=E,document.getElementById("showValidMovesCheckbox").checked=!!h,J(),t?(m!=="online"&&(_e(t),xe(w.length-1),a&&(le("offline",a),u=0)),!0):!1}function Te(e=!1,t=!1){let n=new URL(window.location),l=lang.copy_url,o;if(v&&(Ze?l=lang.copy_spec:l=lang.copy_invite),e||n.searchParams.set("won",x),t)switch(l=lang.copy_result,n.searchParams.delete("timeLimit"),m==="online"?(n.searchParams.delete("room"),o=n.toString().replace(/\/online\//,"/")):o=n.toString(),W){case"en":o=`${S?"Victory!":"Defeated..."}
I played against ${L} and ${S?"won":"lost"} by ${Math.abs($.textContent-M.textContent)} points.

\u3010Final Score\u3011 \u26AB\uFE0F ${$.textContent} : ${M.textContent} \u26AA\uFE0F

#ReversiWeb #Othello

\u{1F447} Game record:
${o}`;break;default:o=`${L}\u306B${Math.abs($.textContent-M.textContent)}\u77F3\u5DEE\u3067\u3010${S?"\u52DD\u5229":"\u6557\u5317"}\u3011

\u7D50\u679C \u25B6 \u26AB\uFE0F ${$.textContent} vs ${M.textContent} \u26AA\uFE0F

#\u30EA\u30D0\u30FC\u30B7Web #\u30AA\u30BB\u30ED #ReversiWeb

\u{1F447} \u68CB\u8B5C\u306F\u3053\u3061\u3089\uFF01
${o}`;break}else o=n.toString();navigator.clipboard.writeText(o).then(()=>{alert(l)}).catch(i=>{alert(lang.copy_failed),console.error("Failed to copy URL: ",i)})}function ne(e=!0){if(v){u=0,localStorage.setItem("timeLimit",u);let t=Math.random().toString(36).substring(2,8),n=`${window.location.origin}/online/?room=${t}`;window.location.pathname.split("/").filter(Boolean)[0]==="en"&&(n=`${window.location.origin}/en/online/?room=${t}`),console.log(`[restart] New room URL: ${n}`),e?window.location.href=n:(Pe=t,history.replaceState(null,"",n))}else{let t=`${window.location.origin}/${m}/`;m==="player"&&(t=`${window.location.origin}/`),window.location.pathname.split("/").filter(Boolean)[0]==="en"&&(t=`${window.location.origin}/en/${m}/`,m==="player"&&(t=`${window.location.origin}/en/`)),localStorage.setItem("deleted_urls",JSON.stringify([])),window.location.href=t}}function kt(){let e=new URL(window.location),t=e.searchParams.get("moves");if(!t){alert(lang.cant_go_more);return}if(t.length>3?e.searchParams.set("moves",t.slice(0,t.lastIndexOf("-"))):e.searchParams.delete("moves"),localStorage.getItem("deleted_urls")===null)localStorage.setItem("deleted_urls",JSON.stringify([t.slice(t.lastIndexOf("-")+1)]));else{let n=JSON.parse(localStorage.getItem("deleted_urls"));n.push(t.slice(t.lastIndexOf("-")+1)),localStorage.setItem("deleted_urls",JSON.stringify(n))}sessionStorage.setItem("scrollY",window.scrollY),window.gtag?gtag("event","go_to_previous_move",{event_category:"navigation",event_label:t.slice(t.lastIndexOf("-")+1)}):console.log("[goToPreviousMove] gtag not found"),window.location=e}function bt(){let e=new URL(window.location),t=e.searchParams.get("moves")?e.searchParams.get("moves")+"-":"",n=JSON.parse(localStorage.getItem("deleted_urls"));n.length>0?(e.searchParams.set("moves",t+n.pop()),localStorage.setItem("deleted_urls",JSON.stringify(n)),sessionStorage.setItem("scrollY",window.scrollY),window.gtag?gtag("event","go_to_next_move",{event_category:"navigation",event_label:n.pop()}):console.log("[goToNextMove] gtag not found"),window.location=e):alert(lang.cant_go_more)}function xe(e,t=!1){y=y.map(n=>n.map(()=>"")),Ke(),console.log("replayMovesUpToIndex",w),w.slice(0,e).forEach(({row:n,col:l,player:o})=>{re(n,l,o,1)}),e>=0&&re(w[e].row,w[e].col,w[e].player,1,t),J()}function Lt(){let e=performance.now(),t=null,n=-1/0,l=y.map(i=>[...i]),o=de();for(let i=0;i<o.length;i++){let[a,r]=o[i],d=Ce(l,a,r,g),s=ae(d,A,!1,-1/0,1/0);if(console.log(`[aiMakeMove] Move (${a},${r}) has score: ${s}`),s>n&&(n=s,t={row:a,col:r}),i===Math.floor(o.length/2)){let D=(performance.now()-e)*2;St(D,E)}}E<=3?setTimeout(()=>Ie(t,u,q,O),800):E<=5?setTimeout(()=>Ie(t,u,q,O),400):Ie(t,u,q,O)}function Ce(e,t,n,l){let o=e.map(i=>[...i]);o[t][n]=l;for(let[i,a]of ge){let r=Bt(o,t,n,i,a,l);for(let[d,s]of r)o[d][s]=l}return o}function Bt(e,t,n,l,o,i){let a=[],r=t+l,d=n+o,s=i==="black"?"white":"black";for(;H(r,d)&&e[r][d]===s;)a.push([r,d]),r+=l,d+=o;return H(r,d)&&e[r][d]===i&&a.length>0?a:[]}function St(e,t){e<t*300?A++:e>t*400&&(A--,e>t*700&&A--),A<0&&(A=0),A>t&&(A=t),console.log(`[aiMakeMove] Adjusted search depth to ${A}`)}function Ie(e,t,n,l){e&&Xe(e.row,e.col,2),t>0&&!n?lt():document.getElementById("timer-display").style.display="none",l&&B.classList.remove("thinking"),O=!1}function ae(e,t,n,l=-1/0,o=1/0){if(t<=0)return xt(e);let i=n?"white":"black",a=n?"black":"white",r=ue(e,i),d=([s,c])=>s===0&&c===0||s===7&&c===0||s===0&&c===7||s===7&&c===7?1e3:s===2&&c===0||s===5&&c===0||s===0&&c===2||s===7&&c===2||s===0&&c===5||s===7&&c===5||s===2&&c===7||s===5&&c===7?900:s===3&&c===0||s===4&&c===0||s===0&&c===3||s===7&&c===3||s===0&&c===4||s===7&&c===4||s===3&&c===7||s===4&&c===7?800:s===2&&c===2||s===2&&c===5||s===5&&c===2||s===5&&c===5?700:s===2&&c===3||s===2&&c===4||s===3&&c===2||s===4&&c===2||s===5&&c===3||s===5&&c===4||s===3&&c===5||s===4&&c===5?600:s===2&&c===1||s===3&&c===1||s===4&&c===1||s===5&&c===1||s===1&&c===2||s===6&&c===2||s===1&&c===3||s===6&&c===3||s===1&&c===4||s===6&&c===4||s===1&&c===5||s===6&&c===5||s===2&&c===6||s===3&&c===6||s===4&&c===6||s===5&&c===6?500:s===1&&c===0||s===6&&c===0||s===0&&c===1||s===7&&c===1||s===0&&c===6||s===7&&c===6||s===1&&c===7||s===6&&c===7?400:s===1&&c===1||s===6&&c===1||s===1&&c===6||s===6&&c===6?300:0;if(r.sort((s,c)=>d(c)-d(s)),r.length===0)return ue(e,a).length===0?(console.log("[aiMakeMove] Game ended"),_t(e)):ae(e,t-1,!n,l,o);if(n){let s=-1/0;for(let[c,D]of r){let z=Ce(e,c,D,i),U=ae(z,t-1,!1,l,o);if(s=Math.max(s,U),l=Math.max(l,U),o<=l)break}return s}else{let s=1/0;for(let[c,D]of r){let z=Ce(e,c,D,i),U=ae(z,t-1,!0,l,o);if(s=Math.min(s,U),o=Math.min(o,U),o<=l)break}return s}}function ue(e,t){let n=[],l=t==="black"?"white":"black";for(let o=0;o<8;o++)for(let i=0;i<8;i++)if(e[o][i]==="")for(let[a,r]of ge){let d=o+a,s=i+r,c=!1;for(;H(d,s)&&e[d][s]===l;)c=!0,d+=a,s+=r;if(c&&H(d,s)&&e[d][s]===t){n.push([o,i]);break}}return n}function _t(e){let t=e.flat().filter(l=>l==="black").length;return(e.flat().filter(l=>l==="white").length-t)*1e3}function xt(e){let i=0,a=0,r=e.flat().filter(f=>f==="black").length,d=e.flat().filter(f=>f==="white").length,s=r+d;if(s===64)return(d-r)*1e3;let c=s/64,D=c*2+.1;i+=r*D,a+=d*D;let z=[[0,0],[0,7],[7,0],[7,7]];for(let[f,k]of z)e[f][k]==="black"?i+=30:e[f][k]==="white"&&(a+=30);let U=[];for(let f=2;f<=5;f++)U.push([0,f],[7,f],[f,0],[f,7]);for(let[f,k]of U)e[f][k]==="black"?i+=5:e[f][k]==="white"&&(a+=5);let st=[[1,1],[1,6],[6,1],[6,6]];for(let[f,k]of st){let oe=Ct(f,k),ye=e[oe[0]][oe[1]],ie=Math.max(0,1-c*1.1);ye===""?(e[f][k]==="black"&&(i-=7*ie),e[f][k]==="white"&&(a-=7*ie)):(ye==="white"&&e[f][k]==="black"||ye==="black"&&e[f][k]==="white")&&(e[f][k]==="black"&&(i-=7*.8*ie),e[f][k]==="white"&&(a-=7*.8*ie))}if(c<.7){let f=(1-c)*.2,k=ue(e,"black").length,oe=ue(e,"white").length;i+=k*f,a+=oe*f}if(E>1){if(E===6){return i-a}return a-i}else return d-r}function Ct(e,t){return e<=3?t<=3?[0,0]:[0,7]:t<=3?[7,0]:[7,7]}function $t(){m==="ai"?(document.getElementById("title").innerHTML='<span id="ai-level-display">'+document.getElementById("aiLevelSelect").options[aiLevelSelect.selectedIndex].text+" AI</span>",document.getElementById("level_ai").style.display="block"):m==="player"?(document.getElementById("title").textContent=player_h1,document.getElementById("level_ai").style.display="none"):m==="online"&&(document.getElementById("title").textContent=online_h1,document.getElementById("level_ai").style.display="none")}function He(e=1e3){setTimeout(()=>{let t=document.createElement("div");t.id="loading-overlay",t.innerHTML=`
        <div class="loading-container">
            <div class="loading-disc">
                <div class="disc-inner"></div>
            </div>
            <div class="loading-text">Loading...</div>
        </div>
    `,document.body.appendChild(t)},e)}function le(e,t=null){S=!1,console.log(`[endGame] Game ended. Winner: ${t}gameMode:`+m);let n=y.flat().filter(a=>a==="black").length,l=y.flat().filter(a=>a==="white").length,o;if(q=!0,m==="ai"&&(L=aiLevelSelect.options[aiLevelSelect.selectedIndex].text+"AI"),t==="won"?(x="won",n>l?o=lang.winner+lang.black:l>n?o=lang.winner+lang.white:o=lang.draw):e!=="offline"?(e.winner===p&&Z(),e.reason==="surrender"?(x=e.winner,o=lang.surrender_winner+(e.winner==="black"?lang.black:lang.white),_&&(e.winner===p?(b.currentTime=0,b.play().catch(a=>{console.warn("audio was blocked:",a)})):(C.currentTime=0,C.play().catch(a=>{console.warn("audio was blocked:",a)})))):e.reason==="timeout"?(x=e.winner,o=lang.timeout_winner+(e.loser==="black"?lang.white:lang.black),_&&(e.winner===p?(b.currentTime=0,b.play().catch(a=>{console.warn("audio was blocked:",a)})):(C.currentTime=0,C.play().catch(a=>{console.warn("audio was blocked:",a)})))):e.reason==="natural"&&(x="won",o=lang.winner+(e.winner==="black"?lang.black:lang.white),_&&(e.winner===p?(b.currentTime=0,b.play().catch(a=>{console.warn("audio was blocked:",a)})):(C.currentTime=0,C.play().catch(a=>{console.warn("audio was blocked:",a)}))))):t?(o=lang.timeout_winner+(t==="black"?lang.black:lang.white),x=t,t==="white"&&m==="ai"||(_&&(b.currentTime=0,b.play().catch(a=>{console.warn("audio was blocked:",a)})),Z())):(x="won",n>l?(o=lang.winner+lang.black,_&&(b.currentTime=0,b.play().catch(a=>{console.warn("audio was blocked:",a)})),Z()):l>n?(o=lang.winner+lang.white,m==="ai"?_&&(C.currentTime=0,C.play().catch(a=>{console.warn("audio was blocked:",a)})):(_&&(b.currentTime=0,b.play().catch(a=>{console.warn("audio was blocked:",a)})),Z())):(o=lang.draw,m==="ai"?_&&(C.currentTime=0,C.play().catch(a=>{console.warn("audio was blocked:",a)})):(_&&(b.currentTime=0,b.play().catch(a=>{console.warn("audio was blocked:",a)})),Z()))),document.getElementById("score_display").innerHTML=`${o} | <span id="black_circle"></span> ${n} : ${l} <span id="white_circle"></span>`,typeof gtag!="undefined")gtag("event","game_result",{result:S,gameMode:m,player_id:N,timeLimit:u,showValidMoves:h,aiLevel:E,gameEndSoundEnabled:_,placeStoneSoundEnabled:Q,playerJoinSoundEnabled:ee,timeLimitSoundEnabled:X});else{console.log("[endGame] gtag not found");return}url=new URL(window.location),url.searchParams.set("won",x),history.pushState(null,"",url);let i=x==="won"?n>l?"black":"white":x;R(),At(S,n,l,i),setTimeout(()=>{if(V++,localStorage.setItem("gameFinishedCount",V),(V===1&&Y||V===3&&Y)&&$e(),Ve()&&!window.navigator.standalone&&V===1)Fe();else if(Ve()&&!window.navigator.standalone&&V===3)Fe();else if(m==="ai"&&S){let a=document.getElementById("aiLevelSelect").value;window.unlockNextAiLevel&&window.unlockNextAiLevel(a)}},2e3)}function Z(){let e=B.getBoundingClientRect(),t=window.innerHeight,n=(e.top+e.height)/t;S=!0,typeof confetti!="undefined"&&(confetti({particleCount:150,angle:75,spread:100,gravity:.2,origin:{x:0,y:n},colors:["#165B33","#BB2528","#146B3A","#EA4630"],shapes:["square","circle"],scalar:.8,zIndex:100}),setTimeout(()=>{confetti({particleCount:150,angle:105,spread:100,gravity:.2,origin:{x:1,y:n},colors:["#165B33","#BB2528","#146B3A","#EA4630"],shapes:["square","circle"],scalar:.8,zIndex:100})},800))}function Mt(e,t=null){if(!(localStorage.getItem("hide"+e+"Dialog")==="true")){e==="role"&&(t==="black"?document.getElementById(e+"-dialog-content").textContent=lang.roleDialogB:document.getElementById(e+"-dialog-content").textContent=lang.roleDialogW),document.getElementById(e+"-dialog").style.display="block",document.getElementById(e+"-dialog-overlay").style.display="block";let l=null;if(e==="role"&&(l=document.getElementById("closeRoleDialog")),l){let o=i=>{i.key==="Enter"&&l.click()};document.addEventListener("keydown",o),l.addEventListener("click",()=>{document.removeEventListener("keydown",o)})}}}function We(e){document.getElementById(e+"-dialog").style.display="none",document.getElementById(e+"-dialog-overlay").style.display="none",localStorage.setItem("hide"+e+"Dialog",document.getElementById(e+"-not-checkbox").checked)}function Pt(){["https://reversi.yuki-lab.com/static/game/images/win.png","https://reversi.yuki-lab.com/static/game/images/lose.png","https://reversi.yuki-lab.com/static/game/images/draw.png","https://reversi.yuki-lab.com/static/game/images/laurel.webp"].forEach(t=>{let n=new Image;n.src=t})}function At(e,t,n,l){let o=t===n?x==="won":!1,i="";switch(e?i="https://reversi.yuki-lab.com/static/game/images/win.png":o?(i="https://reversi.yuki-lab.com/static/game/images/draw.png",qe.style.backgroundImage="none"):(i="https://reversi.yuki-lab.com/static/game/images/lose.png",qe.style.backgroundImage="none"),W){case"en":o?we.textContent=`\u{1F91D} You drew with ${L}`:we.textContent=(e?"\u{1F3C6}\uFE0F ":"")+(typeof L=="undefined"?l==="black"?"Black":"White":"You")+(e?" won":" lost")+(typeof L=="undefined"?"":` against ${L}`)+` by ${Math.abs(t-n)} points!`;break;default:we.textContent=(e?"\u{1F3C6}\uFE0F ":"")+(typeof L=="undefined"?l==="black"?"\u9ED2\u304C":"\u767D\u304C":`${L}\u306B`)+`${Math.abs(t-n)}\u70B9\u5DEE\u3067${S?"\u52DD\u5229\uFF01":o?"\u5F15\u304D\u5206\u3051":"\u6557\u5317"}`;break}ft.textContent=`\u26AB\uFE0F ${t} : ${n} \u26AA\uFE0F`,gt.src=i,te.style.display="block",Ae.style.display="block"}function ot(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function Fe(){document.getElementById("ios-install-guide").style.display="block"}function $e(){Y.prompt(),Y.userChoice.then(()=>{Y=null})}function Tt(){let e,t,n;m==="ai"?(e=ai_title,t=lang.ai_description,n="https://reversi.yuki-lab.com/ai/"):m==="player"?(e=player_title,t=lang.player_description,n="https://reversi.yuki-lab.com/"):m==="online"?(e=online_title,t=lang.online_description,n="https://reversi.yuki-lab.com/online/"):(e=else_title,t=lang.else_description,n="https://reversi.yuki-lab.com/"),document.title=e;let l=document.querySelector('meta[name="description"]');l||(l=document.createElement("meta"),l.setAttribute("name","description"),document.head.appendChild(l)),l.setAttribute("content",t);let o=document.querySelector("link[rel='canonical']");o||(o=document.createElement("link"),o.setAttribute("rel","canonical"),document.head.appendChild(o)),o.setAttribute("href",n)}function Nt(){var e=document.createElement("script");e.src="https://www.googletagmanager.com/gtag/js?id=G-4JKZC3VNE7",e.async=!0,e.nonce="{{ request.csp_nonce }}",document.head.appendChild(e),window.dataLayer=window.dataLayer||[],window.gtag=function(){dataLayer.push(arguments)},e.onload=function(){gtag("js",new Date),gtag("config","G-4JKZC3VNE7",{cookie_domain:"auto"})},"requestIdleCallback"in window?requestIdleCallback(je):setTimeout(je,1e3)}function je(){if(function(t,n,l,o,i,a,r){console.log("Clarity script loaded"),t[l]=t[l]||function(){(t[l].q=t[l].q||[]).push(arguments)},a=n.createElement(o),a.async=1,a.src="https://www.clarity.ms/tag/"+i,a.nonce="{{ request.csp_nonce }}",r=n.getElementsByTagName(o)[0],r.parentNode.insertBefore(a,r)}(window,document,"clarity","script","qy90xxylfc"),!window.adsLoaded){window.adsLoaded=!0;var e=document.createElement("script");e.src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1918692579240633",e.defer=!0,e.nonce="{{ request.csp_nonce }}",document.head.appendChild(e)}Pt()}b.volume=.013;C.volume=.012;se.volume=.08;ke.volume=.1;u===0?document.getElementById("timeLimitBox_").style.display="none":document.getElementById("timeLimitBox_").style.display="block";document.readyState!=="loading"?(document.removeEventListener("DOMContentLoaded",Ee),Ee()):window.addEventListener("DOMContentLoaded",Ee);document.querySelectorAll(".mode-btn").forEach(e=>{e.addEventListener("click",function(){let t=this.getAttribute("data-mode"),n=m;if(m=t,t!==n){if(localStorage.setItem("gameMode",t),document.querySelectorAll(".mode-btn").forEach(l=>l.classList.remove("active")),this.classList.add("active"),$t(),fe(),Tt(),t!=="ai"){let l=new URL(window.location);l.searchParams.delete("aiLevel"),history.replaceState(null,"",l)}if(t==="online")v=!0,He(),ne();else if(document.getElementById("playerJoinSoundBox").style.display="none",ce&&(ce.style.display="none"),n==="online"){v=!1;let l=new URL(window.location);l.searchParams.delete("room"),history.pushState(null,"",l),I&&(I.close(),I=null),He(),ne()}else t==="ai"&&(m==="ai"&&g==="white"&&!q&&Qe(),at());document.getElementById("game-container").scrollIntoView({behavior:"smooth"})}})});function Ot(e){console.log(`[processPassMessage] Received pass message: ${JSON.stringify(e)}, old currentPlayer: ${g}`),g=e.new_turn,alert(g===p?lang.opponent_pass:lang.you_pass),J()}function Rt(e,t){let n={action:"place_stone",row:e,col:t,player:g};console.log("Sending WebSocket move:",n),console.log("online?:",v),I.send(JSON.stringify(n))}function it(){document.getElementById("timeLimitContainer").style.display="none",document.getElementById("validContainer").style.display="none"}function Dt(e){console.log(`[updatePlayerList] Updating player list: ${JSON.stringify(e)}`);let t=document.getElementById("player-list");if(t.innerHTML="",Object.entries(e).forEach(([n,[l,o]])=>{let i=l==="black"?lang.black:l==="white"?lang.white:lang.spec,a=document.createElement("span");n===N?(a.style.fontWeight="bold",display_player_name=lang.you+`\uFF08${o}\uFF09`):(display_player_name=o,l!=="spectator"&&(L=o)),a.innerHTML=(i!==lang.black?"\u3000":"")+`${i===lang.black?'<span id="black_circle"></span>':i===lang.white?'<span id="white_circle"></span>':i+":"} ${ot(display_player_name)}`,t.appendChild(a)}),Object.keys(e).length===1){let n=document.createElement("span");n.innerHTML='\u3000<span id="white_circle"></span> '+lang.opponent,t.appendChild(n)}}function Ut(){let e=Ht.value,t=Wt.checked;u=e,h=t?"true":"false",localStorage.setItem("timeLimit",u),localStorage.setItem("showValidMoves",h),I.send(JSON.stringify({action:"game_setting",time_limit:u,show_valid_moves:h,player_name:P}))}function qt(){I=new WebSocket(`${dt}://${window.location.host}/ws/othello/${Pe}/?playerId=${N}&timeLimit=${u}&showValidMoves=${h}&playerName=${encodeURIComponent(P)}&lang=${W}`),I.onopen=function(e){console.log("WebSocket connection established.",e)},I.onmessage=function(e){console.log("WebSocket message received:",e.data);let t=JSON.parse(e.data);if(t.error){alert(`\u26A0\uFE0F ${t.error}`);return}if(t.action==="place_stone")B.innerHTML="",be(),Le(),_e(t.history),console.log("moveHistory",w),xe(w.length-1,1);else if(t.action==="assign_role")p=t.role,console.log(`\u3042\u306A\u305F\u306E\u5F79\u5272: ${p}, \u30C7\u30FC\u30BF${t}, (ID: ${N}), \u518D\u63A5\u7D9A${t.reconnect}, \u30ED\u30FC\u30EB${p}`),t.n_players===1&&(ce.style.display="flex"),t.reconnect===!0?(B.innerHTML="",be(),Le(),_e(t.history),console.log("moveHistory",w),xe(w.length-1,2),R(),document.getElementById("timer-display").textContent="- : --",u=t.time_limit,localStorage.setItem("timeLimit",u),document.getElementById("timeLimitSelect").value=u,console.log(`\u30B2\u30FC\u30E0\u304C\u518D\u958B\u3055\u308C\u307E\u3057\u305F\u3002${t.show_valid_moves}`),h=t.show_valid_moves==="true",localStorage.setItem("showValidMoves",h),document.getElementById("showValidMovesCheckbox").checked=h,u===0?document.getElementById("timeLimitBox_").style.display="none":document.getElementById("timeLimitBox_").style.display="block",t.n_players!==1&&(document.getElementById("restart-btn").disabled=!1,document.getElementById("surrender-btn").disabled=!1),console.log("reconnect",t)):(u=0,localStorage.setItem("timeLimit",u),R(),document.getElementById("timeLimitBox_").style.display="none");else if(t.action==="update_players"){if(Dt(t.players),t.by_reconnect)return;if(Object.keys(t.players).length===2&&!t.setting){p==="black"&&Ut(),Mt("role",p),ce.style.display="none";let n=document.getElementById("qr-popup");n.style.display="none",tt(),document.getElementById("restart-btn").disabled=!1,document.getElementById("surrender-btn").disabled=!1}if(ee&&t.player_id!==N&&(ke.currentTime=0,ke.play().catch(n=>{console.warn("audio was blocked:",n)})),t.setting){R(),u=t.time_limit,localStorage.setItem("timeLimit",u),document.getElementById("timeLimitSelect").value=u,h=t.show_valid_moves==="true",localStorage.setItem("showValidMoves",h),document.getElementById("showValidMovesCheckbox").checked=h;let n=document.getElementById("timer-display");u===0?(document.getElementById("timeLimitBox_").style.display="none",n.style.display="none"):(document.getElementById("timeLimitBox_").style.display="block",n.style.display="block",n.textContent=me(u))}}else if(t.action==="pass"){Ot(t);return}else if(t.action==="game_over"){le(t,t.winner);return}else if(t.action==="game_start"){console.log(`Game started. ${t.time_limit},${t.show_valid_moves}.`),Ze=!0;return}}}function Jt(e){return e.replace(/[Ａ-Ｚａ-ｚ０-９]/g,function(t){return String.fromCharCode(t.charCodeAt(0)-65248)})}function Ee(){let e=document.getElementById("qr"),t=document.getElementById("qr-popup"),n=document.getElementById("qrcode");var l=document.getElementById("dynamic-fonts"),o=document.getElementById("dynamic-css");l&&(l.media="all"),o&&(o.media="all");let i=sessionStorage.getItem("scrollY");if(console.log("scrollY",i),i!==null&&(window.scrollTo(0,parseInt(i)),sessionStorage.removeItem("scrollY")),ze=Vt(PLACE_STONE_SOUND).then(a=>{console.log("Audio preloaded")}).catch(a=>console.error("Failed to preload audio:",a)),document.getElementById("title").addEventListener("click",function(){m==="ai"||location.reload()}),document.querySelectorAll(".mode-btn").forEach(a=>{a.getAttribute("data-mode")===m&&a.classList.add("active")}),m==="online")e.addEventListener("click",function(){let a=window.location.href;n.innerHTML="",console.log("qr"),new QRCode(n,{text:a,width:200,height:200}),t.style.display="flex",document.addEventListener("click",r=>{!r.target.closest(".qr-popup")&&r.target.id!=="qr-icon"&&(console.log("close"+r.target),t.style.display="none")})}),rt.addEventListener("click",function(){Te(!0)}),it(),v=!0,document.getElementById("playerJoinSoundBox").style.display="block",Pe===null&&ne(!1);else{v=!1;let a=new URL(window.location);a.searchParams.delete("room"),history.replaceState(null,"",a),I&&(I.close(),I=null),document.getElementById("playerJoinSoundBox").style.display="none",m==="ai"?document.getElementById("level_ai").style.display="block":document.getElementById("level_ai").style.display="none"}m==="ai"&&at(),Nt()}function at(){let e=document.getElementById("aiLevelSelect");document.getElementById("ai-level-display").addEventListener("click",function(){let i=document.getElementById("ai-level-popup");i.style.display=i.style.display!=="block"?"block":"none",l()});let t=JSON.parse(localStorage.getItem("unlockedAiLevels")||'{"0":true,"1":true,"2":true,"6":true}');console.log(`[aiLevelSelect] Unlocked levels: ${JSON.stringify(t)}`),document.querySelectorAll(".locked-level").forEach(i=>{let a=i.getAttribute("data-unlock-level");if(console.log(`[aiLevelSelect] Locking level v ${i.getAttribute("data-level")}`),console.log(`[aiLevelSelect] Locking level t ${i.textContent}`),t[i.getAttribute("data-level")||i.value])i.classList.remove("locked-level"),i.disabled=!1,i.style.display="";else if(t[a]){let r=document.querySelector('#aiLevelSelect option[value="'+a+'"]');switch(i.getAttribute("data-level")&&(Ue=i.textContent),W){case"en":i.textContent=`Next Level: Defeat ${r.textContent} to unlock`;break;default:i.textContent=`\u6B21\u306E\u30EC\u30D9\u30EB : ${r.textContent}AI\u306B\u52DD\u5229\u3067\u89E3\u653E`;break}i.disabled=!0}else i.style.display="none"}),window.unlockNextAiLevel=function(i){let a=Array.from(e.querySelectorAll(".locked-level")).find(r=>r.getAttribute("data-unlock-level")==i);if(a){let r=a.value;t[r]=!0,localStorage.setItem("unlockedAiLevels",JSON.stringify(t)),alert(lang.congrats_aiLevel_unlocked_b+Ue+lang.congrats_aiLevel_unlocked_a),document.getElementById("restart-match").textContent=lang.nextLevel,localStorage.setItem("aiLevel",r)}};function l(){let i=e.options[e.selectedIndex].text,a=document.getElementById("ai-level-display");a.textContent=`${i} AI`,document.querySelectorAll(".ai-level-item").forEach(d=>{d.getAttribute("data-level")===e.value?d.classList.add("selected"):d.classList.remove("selected")})}document.querySelectorAll(".ai-level-item").forEach(i=>{i.addEventListener("click",function(){if(this.classList.contains("locked-level"))return;let a=this.getAttribute("data-level");e.value=a;let r=new Event("change");e.dispatchEvent(r),l(),document.getElementById("ai-level-popup").style.display="none";let d=new URL(window.location);d.searchParams.delete("moves"),d.searchParams.delete("won"),d.searchParams.set("aiLevel",a),history.pushState(null,"",d),location.reload()})}),document.addEventListener("click",function(i){let a=document.getElementById("ai-level-popup");a.style.display==="block"&&!a.contains(i.target)&&i.target!==document.getElementById("ai-level-display")&&(a.style.display="none")}),e.addEventListener("change",l),setTimeout(l,100)}async function Vt(e){if(j)return j;let n=await(await fetch(e)).arrayBuffer();return j=await T.decodeAudioData(n),j}async function Ge(){if(T.state==="suspended"&&await T.resume().then(()=>{console.log("AudioContext resumed."),he=!0}).catch(l=>{console.warn("Failed to resume AudioContext:",l)}),!j)try{await ze}catch(l){console.warn("Buffer failed to load:",l);return}let e=j;if(!e)return;let t=T.currentTime;if(he)he=!1;else if(t-Re<.1)return;Re=t;let n=T.createBufferSource();n.buffer=e,n.connect(Me),n.start(0)}window.addEventListener("beforeunload",async()=>{T.state!=="closed"&&await T.close()});window.location.hostname!=="127.0.0.1"&&(console.log("Skipping source maps in production."+window.location.hostname),window.addEventListener("error",e=>{e.filename.includes(".js.map")&&e.preventDefault()}));ct.addEventListener("click",Te);document.getElementById("r-share-btn").addEventListener("click",()=>{Te(!1,!0)});document.getElementById("restart-btn").addEventListener("click",ne);document.getElementById("prev-move-btn").addEventListener("click",kt);document.getElementById("next-move-btn").addEventListener("click",bt);window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),Y=e;let t=document.getElementById("install-btn");t.style.display="block",t.addEventListener("click",$e)});window.addEventListener("appinstalled",()=>{alert(lang.thanks_install);let e=navigator.userAgent.includes("Chrome")?"Chrome":navigator.userAgent.includes("Safari")?"Safari":navigator.userAgent.includes("Firefox")?"Firefox":"Other";gtag("event","pwa_installed",{event_category:"engagement",event_label:"PWA Installed",browser:e,timestamp:new Date().toISOString(),id:N,game_mode:m,gameFinishedCount:V,Won:S})});document.getElementById("showValidMovesCheckbox").addEventListener("change",()=>{h=document.getElementById("showValidMovesCheckbox").checked,localStorage.setItem("showValidMoves",h),J(),fe()});var Ht=document.getElementById("time-limit"),Wt=document.getElementById("highlight-moves"),Ye=document.getElementById("closeRoleDialog");Ye&&(Ye.addEventListener("click",()=>{We("role")}),document.getElementById("role-dialog-overlay").addEventListener("click",()=>{We("role")}));De&&(De.addEventListener("click",()=>{confirm(lang.surrender_right)&&I.send(JSON.stringify({action:"surrender"}))}),document.getElementById("info-button").addEventListener("click",function(){alert(`${lang.how2play_with_friend}`)}));var F=document.getElementById("player-name");if(F){F.value=P;let e=document.getElementById("warning");F.addEventListener("change",()=>{let t=Jt(F.value.trim());t.length>0?(F.value=t,/^[a-zA-Z0-9]+$/.test(t)?(P=profanityCleaner.clean(t),document.getElementById("player-list").children[0].innerHTML='<span id="black_circle"></span> '+lang.you+"("+ot(P)+")",F.value=P,localStorage.setItem("playerName",P),e.textContent=""):e.textContent=lang.warn_EnOnly):e.textContent=lang.warn_charLimit})}document.getElementById("setting").addEventListener("click",()=>{document.getElementById("settings").scrollIntoView({behavior:"smooth"})});document.getElementById("close-install-guide").addEventListener("click",()=>{if(document.getElementById("ios-install-guide").style.display="none",m==="ai"&&S){let e=document.getElementById("aiLevelSelect").value;window.unlockNextAiLevel&&window.unlockNextAiLevel(e)}});document.getElementById("timeLimitSelect").value=u;document.getElementById("timeLimitSelect").addEventListener("change",()=>{if(u=parseInt(document.getElementById("timeLimitSelect").value),localStorage.setItem("timeLimit",u),u===0)document.getElementById("timeLimitBox_").style.display="none";else{let e=document.getElementById("timer-display");R(),e.classList.remove("warning1","warning2"),e.style.display="inline-block",e.textContent=me(u),document.getElementById("timeLimitBox_").style.display="block"}});document.getElementById("aiLevelSelect").value=E;document.getElementById("aiLevelSelect").addEventListener("change",()=>{E=parseInt(document.getElementById("aiLevelSelect").value),localStorage.setItem("aiLevel",E)});document.getElementById("soundEffectsCheckbox").addEventListener("change",()=>{Q=document.getElementById("soundEffectsCheckbox").checked,localStorage.setItem("soundEffects",Q)});document.getElementById("timeLimitSoundCheckbox").addEventListener("change",()=>{X=document.getElementById("timeLimitSoundCheckbox").checked,localStorage.setItem("timeLimitSoundEnabled",X)});document.getElementById("playerJoinSoundCheckbox").addEventListener("change",()=>{ee=document.getElementById("playerJoinSoundCheckbox").checked,localStorage.setItem("playerJoinSoundEnabled",ee)});document.getElementById("gameEndSoundCheckbox").addEventListener("change",()=>{_=document.getElementById("gameEndSoundCheckbox").checked,localStorage.setItem("gameEndSoundEnabled",_)});window.addEventListener("popstate",function(e){location.reload()});document.getElementById("soundEffectsCheckbox").checked=Q;document.getElementById("timeLimitSoundCheckbox").checked=X;document.getElementById("gameEndSoundCheckbox").checked=_;document.getElementById("playerJoinSoundCheckbox").checked=ee;function Ft(){Ae.style.display="none",te.classList.add("collapsed")}function jt(){Ae.style.display="block",te.classList.remove("collapsed")}document.getElementById("close-result").addEventListener("click",()=>{document.getElementById("restart-btn").classList.add("shine-button"),Ft()});te.addEventListener("click",e=>{te.classList.contains("collapsed")&&e.target!==document.getElementById("close-result")&&(e.stopPropagation(),jt())});document.getElementById("tweet-result").addEventListener("click",()=>{let e=new URL(window.location);e.searchParams.delete("room"),e.searchParams.delete("timeLimit"),e=e.toString();let t=$.textContent===M.textContent?x==="won":!1;m==="online"&&(e=e.replace(/\/online\//,"/"));let n="";switch(W){case"en":t?n=`\u{1F91D} I drew with ${L}!

\u3010Final Score\u3011 \u26AB\uFE0F ${$.textContent} : ${M.textContent} \u26AA\uFE0F

#ReversiWeb #Othello

\u{1F447} Game record:
${e}`:n=`${S?"Victory!":"Defeated..."}
I ${typeof L=="undefined"?"":` against ${L} and`} ${S?"won":"lost"} by ${Math.abs($.textContent-M.textContent)} points.

\u3010Final Score\u3011 \u26AB\uFE0F ${$.textContent} : ${M.textContent} \u26AA\uFE0F

#ReversiWeb #Othello

\u{1F447} Game record:
${e}`;break;default:n=`${typeof L=="undefined"?"":`${L}\u306B`}${Math.abs($.textContent-M.textContent)}\u77F3\u5DEE\u3067\u3010${S?"\u52DD\u5229":"\u6557\u5317"}\u3011

\u7D50\u679C \u25B6 \u26AB\uFE0F ${$.textContent} vs ${M.textContent} \u26AA\uFE0F

#\u30EA\u30D0\u30FC\u30B7Web #\u30AA\u30BB\u30ED #ReversiWeb

\u{1F447} \u68CB\u8B5C\u306F\u3053\u3061\u3089\uFF01
${e}`;break}let l=`https://twitter.com/intent/tweet?text=${encodeURIComponent(n)}`;window.open(l,"_blank")});document.getElementById("restart-match").addEventListener("click",()=>{gtag("event","next_match",{event_category:"engagement",event_label:S?"NextMatch_afterVictory":"NextMatch_afterDefeated",gameEndSoundEnabled:_}),ne()});yt();})();
//! 「最弱級」指定のAI。評価関数は敢えて反転させる
