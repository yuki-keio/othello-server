{% load static %}
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="{% static 'game/style.css' %}">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=BIZ+UDGothic:wght@400;700&family=BIZ+UDPMincho:wght@400;700&display=swap"
    media="print" id="dynamic-fonts" >
    <script nonce="{{ request.csp_nonce }}">
        const PLACE_STONE_SOUND = "{% static 'game/sounds/place-stone.mp3' %}";

  
    </script>
    

    <script defer src="{% static 'game/script.js' %}"></script>

    <meta name="description" content="
    {% if mode == 'online' %}
        リバーシ（オセロ）のオンライン対戦ができる無料Webゲームサイト。離れた場所にいる相手とも、リアルタイムで通信対戦が可能です。ブラウザさえあれば、オセロ盤の用意やアプリのダウンロードが一切不要！スマホ・PC・iPadなど好きなデバイスから、オセロゲームの友達対戦が無料でできるWebサイトです。（旧サービス名：スマートオセロ）
    {% elif mode == 'ai' %}
        AIとリバーシ（オセロ）対戦！一人で楽しめる無料Webゲームです。スマホ・PC・iPadなどデバイス一台で、リバーシが無料で遊べます。ブラウザさえあれば、オセロ盤の用意やアプリのインストールが必要ないので、Web上で気軽にオセロを楽しみたい人におすすめ！（旧サービス名：スマートオセロ）
    {% elif mode == 'player' %}
        リバーシが遊べる無料の電子オセロ盤！。オセロ盤の用意やアプリのインストールは必要なし！リバーシの友達対戦をブラウザで遊べるスマートなWebオセロ盤です。スマホ・PC・iPadなどWebが使えるデバイス一台あればどこでも遊べるので、旅行先でのレクリエーションにもオススメ。ブラウザゲーの定番です（旧サービス名：スマートオセロ）
    {% else %}
        リバーシ（オセロ）の無料Webゲーム。オンライン対戦・AI対戦・オフライン対戦が可能！アプリ不要でブラウザからすぐ遊べます。（旧サービス名：スマートオセロ）
    {% endif %}
">

    <title>
        {% if mode == 'online' %}
            リバーシ（オセロ）オンライン対戦 | リバーシWeb - ブラウザで遊べる無料ゲーム
        {% elif mode == 'ai' %}
            リバーシ（オセロ）AI対戦 | リバーシWeb - ブラウザで遊べる無料ゲーム
        {% elif mode == 'player' %}
            リバーシ（電子オセロ盤） | リバーシWeb - ブラウザで遊べる無料ゲーム
        {% else %}
            リバーシWeb - ブラウザで遊べる無料オセロゲーム
        {% endif %}
    </title>    
  
    <script async src="https://cdn.jsdelivr.net/npm/profanity-cleaner@latest?source=false"></script>
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <meta property="og:title" content="リバーシWeb">
    <meta property="og:description" content="オンラインで楽しめるリバーシゲーム！（オセロ）">
    <meta property="og:image" content="https://reversi.yuki-lab.com/static/game/images/share-image.png">
    <meta property="og:url" content="https://reversi.yuki-lab.com">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="リバーシWeb | 無料オセロゲーム">
    <meta name="twitter:description" content="ダウンロード不要！友達対戦やAIとの対戦が可能なブラウザゲームです">
    <meta name="twitter:image" content="https://reversi.yuki-lab.com/static/game/images/share-image.png">
    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "SoftwareApplication",
            "name": "リバーシWeb - ブラウザで遊べる無料ゲーム",
            "additionalType": ["https://schema.org/VideoGame", "https://schema.org/WebApplication"],
            "applicationCategory": "Game",
            "alternateName": "無料オセロゲームのスマートオセロ",
            "description": "一人で遊べるAI対戦も友達とのオンライン対戦も可能な無料のリバーシ（オセロゲーム）。ブラウザで今すぐプレイ！",
            "image": "https://reversi.yuki-lab.com/static/game/images/share-image.png",
            "url": "https://reversi.yuki-lab.com",
            "operatingSystem": "Web",
            "genre": "Board game",
            "gamePlatform": "Web",
            "gameMode": ["SinglePlayer", "AI", "Multiplayer"],
            "offers": {
              "@type": "Offer",
              "price": "0",
              "priceCurrency": "JPY"
            },
            "hasPart": [
              {
                "@type": "WebPage",
                "name": "電子オセロ盤",
                "url": "https://reversi.yuki-lab.com/player"
              },
              {
                "@type": "WebPage",
                "name": "オセロAIと対戦",
                "url": "https://reversi.yuki-lab.com/ai"
              },
              {
                "@type": "WebPage",
                "name": "通信対戦",
                "url": "https://reversi.yuki-lab.com/online"
              }]

          }
        </script>

    <link rel="shortcut icon" type="image/vnd.microsoft.icon" href="{% static 'game/images/favicon/favicon.ico' %}">
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'game/images/favicon/apple-touch-icon.png' %}">
    <link rel="icon" type="image/png" sizes="16x16" href="{% static 'game/images/favicon/favicon-16x16.png' %}">
    <link rel="icon" type="image/png" sizes="32x32" href="{% static 'game/images/favicon/favicon-32x32.png' %}">
    <link rel="icon" type="image/png" sizes="48x48" href="{% static 'game/images/favicon/favicon-48x48.png' %}">
    <link rel="icon" type="image/png" sizes="96x96" href="{% static 'game/images/favicon/favicon-96x96.png' %}">
    <link rel="icon" type="image/png" sizes="192x192" href="{% static 'game/images/favicon/favicon-192x192.png' %}">
    <link rel="manifest" href="{% static 'game/images/favicon/manifest.json' %}">
    
    <meta name="theme-color" content="#007508">

    <link rel="canonical" href="
    {% if mode == 'online' %}
        https://reversi.yuki-lab.com/online/
    {% elif mode == 'ai' %}
        https://reversi.yuki-lab.com/ai/
    {% elif mode == 'player' %}
        https://reversi.yuki-lab.com/player/
    {% else %}
        https://reversi.yuki-lab.com/
    {% endif %}
    ">

    
    <!-- Google Analytics 最適化 -->
    <script nonce="{{ request.csp_nonce }}">
        function loadGoogleAnalytics() {
            var script = document.createElement('script');
            script.src = "https://www.googletagmanager.com/gtag/js?id=G-4JKZC3VNE7";
            script.async = true;
            script.nonce = "{{ request.csp_nonce }}"; // CSP対応
            document.head.appendChild(script);

            script.onload = function () {
                window.dataLayer = window.dataLayer || [];
                function gtag(){dataLayer.push(arguments);}
                gtag('js', new Date());
                gtag('config', 'G-4JKZC3VNE7', { 'cookie_domain': 'auto' });
            };
            if ('requestIdleCallback' in window) {
               // requestIdleCallback(loadAdSense);
            } else {
               // setTimeout(loadAdSense, 1000);
            }
        }

        


        function loadAdSense() {
            if (!window.adsLoaded) {
                window.adsLoaded = true;
                var script = document.createElement('script');
                script.src = "https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1918692579240633";
                script.defer = true;
                script.nonce = "{{ request.csp_nonce }}"; // CSP対応
                document.head.appendChild(script);
            }
        }
        document.addEventListener("DOMContentLoaded", loadGoogleAnalytics);
    </script>
    
</head>
<body>
<div id="game-container">
        <!-- モード選択バナー -->
        <div id="mode-selection-banner">
            <button class="mode-btn" data-mode="player">オセロ盤</button>
            <button class="mode-btn" data-mode="ai">AI対戦</button>
            <button class="mode-btn" data-mode="online">通信対戦</button>
        </div>
        <h1 id="title">
            {% if mode == 'online' %}
                オンライン対戦
            {% elif mode == 'ai' %}
                オセロAI対戦
            {% elif mode == 'player' %}
                オセロ盤モード
            {% else %}
                リバーシWeb
            {% endif %}
        </h1>
    
        <img src="{% static 'game/images/setting.svg' %}" alt="リバーシ（オセロ）の設定" id="setting">
        <div id="player-info"><ul id="player-list"></ul></div>
        <span id="timer-display"></span>
        <div id="board-container">
            <div id="board" role="grid" >
            </div>
            
            {% if mode == 'online' %}
            <div id="game-settings-overlay">
                <div id="game-settings">
                    <h3>対戦設定</h3>

                    <div id="contents-overlay-setting">
                        <div id="player-name-container">
                            <label for="player-name" id="label4name">表示名：</label>
                            <input type="text" id="player-name" placeholder="英数字のみ入力可能">
                            <div id="warning"></div>
                          
                        </div>
                        <label id="time_overlay-label">持ち時間：
                            <select id="time-limit">
                                <option value="0">制限なし</option>
                                <option value="10">10秒</option>
                                <option value="30">30秒</option>
                                <option value="60">1分</option>
                                <option value="180">3分</option>
                                <option value="300">5分</option>
                            </select>
                        </label>
                        <br>
                        <label>
                            <input type="checkbox" id="highlight-moves" checked> 有効な手をハイライト表示
                        </label>
                    </div>
                    <div class="invite-container">

                    <button id="start-match" class="btn-primary">招待URLをコピー</button>
                    <button id="qr">
                        <img src="{% static 'game/images/qr.svg' %}" alt="オセロ対戦への招待用QRコード" id="qr-icon">
                    </button>
                    </div>
                </div>
            </div>
            <!-- QRコード用のポップアップ -->
            <div id="qr-popup" class="qr-popup">
                <div class="qr-popup-content">
                    <span id="close-qr" class="close">&times;</span>
                    <h3>招待用QRコード</h3>
                    <div id="qrcode"></div>
                </div>
            </div>

            {% endif %}
        </div>
        <div id="status">
            <span class="current-player" id="c_black">黒番</span>
            <div id="black_circle"></div>
            <span id="score_black"></span>：<span id="score_white"></span>
            <div id="white_circle"></div>

            <span class="current-player" id="c_white">白番</span>

        </div>
        <div id="copy-tooltip" class="tooltip">コピーして観戦者や<br>対戦相手を招待！</div>

    <div class="buttons_container">
        <button id="copy-url-btn" aria-label="オセロ盤の盤面を共有するURLをコピー"></button>
        <button id="surrender-btn" aria-label="投了">投了</button>
        <button id="restart-btn" aria-label="新しい対局を開始">🚩 新規対局</button>
    </div>
        <div id="move-history">
            <h3>棋譜</h3>
            
            <button id="prev-move-btn">＜</button>
            <button id="next-move-btn">＞</button>
            
            <pre id="move-list">　棋譜はまだありません</pre>

        </div>
        

        <div id="settings">
            <h3>設定</h3>
            <div class="container">
                🔈 効果音： <br>
                <div id="soundSettingContainer">
                <label>
                    <input type="checkbox" id="gameEndSoundCheckbox" checked> 勝利 / 敗北
                </label> <br><br>
                <label>
                    <input type="checkbox" id="soundEffectsCheckbox" checked> 石を置く
                </label> <br><br>
                <div id="timeLimitBox_">
                    <label>
                        <input type="checkbox" id="timeLimitSoundCheckbox" checked> 残り時間あと少し
                    </label> <br><br>
                </div>
                <div id="playerJoinSoundBox">
                    <label>
                        <input type="checkbox" id="playerJoinSoundCheckbox" checked> プレイヤー参加
                    </label> <br><br>
                </div>
                

                </div>

               
                
                <div id="timeLimitContainer">
                <label>
                    ⏱ 一手あたりの持ち時間： 
                    <select id="timeLimitSelect">
                        <option value="0">制限なし</option>
                        <option value="300">5分</option>
                        <option value="180">3分</option>
                        <option value="60">1分</option>
                        <option value="30">30秒</option>
                        <option value="10">10秒</option>
                        
                    </select>
                </label>
                </div>
                <br>
                <label id="level_ai">
                    🤖 AIのレベル：
                    <select id="aiLevelSelect">
                        <option value="0">初級</option>
                        <option value="2">中級</option>
                        <option value="9">上級</option>
                    </select>
                </label>
                <div id="validContainer">
                    <label>
                        👍
                        <input type="checkbox" id="showValidMovesCheckbox" checked> 有効な手をハイライト
                    </label>
                </div>
                <br>
                
               
             
                  

                <div class="caution">
                    ※ 変更後の持ち時間は、次の一手から適用されます。 <br>
                    ※ 持ち時間がゼロになると <strong>直ちに負け</strong> となる設計のため、ご注意ください。そのままURLをリロードすると、持ち時間をリセットして再開できます。                    
                    
                </div>
            </div>
        </div>  
        <!--<a href="https://pc.moppy.jp/entry/invite.php?invite=y22tA17c&type=service"><img decoding="async" loading="lazy" src="https://img.moppy.jp/pub/pc/friend/640x480-13.jpg" alt="アプリインストール・ゲームアプリで無料で簡単にポイントが貯まる！楽しくポイ活するならモッピー" id="ad" ></a>
        -->
    <section class="notes">
        <h2>本サイト・リバーシWebの機能</h2>
        <p>リバーシ（オセロゲーム）が無料ですぐ遊べるWebサイトです。<a href="https://reversi.yuki-lab.com/ai/">CPU対戦</a>、<a href="https://reversi.yuki-lab.com/online/">オンライン対戦</a>、<a href="https://reversi.yuki-lab.com/player/">電子オセロ盤モード</a>など、様々な機能に対応しています。 <strong>独自のURLシェア機能</strong> によって、友達との対戦や観戦、棋譜の共有などが簡単に行える点も特徴です</p>
        <h3>機能のオン・オフ</h3>
        <p>効果音・ハイライト表示・制限時間の機能は、<a href="#settings">「設定」</a>からオン・オフを切り替えられます。次回以降に同じブラウザで遊ぶ場合もその設定を引き継げます。</p>
        <div class="small">※ ただし通信対戦モードが選択された場合は、通信対戦における設定に合わせてハイライト表示設定が変更されます。</div>
        <h3>アプリ版で遊ぶ</h3>
        <p>本サイトはブラウザゲームですが、Webアプリ（PWA）としてホーム画面に追加することもできます。Webアプリの特徴として、デバイスの容量はほぼ消費せず、さらに起動も高速になります。アプリ版では主な機能をオフラインでも利用できます。アプリ設置の所要時間は数秒です。ぜひお試しください</p>
        <button id="install-btn">Webアプリとしてホーム画面に追加</button>


    </section>

    <section class ="notes" id="rules">
        <h2>リバーシ（オセロ）のルール</h2>
    
        <h3>基本ルール</h3>
        <p>リバーシは 8×8 の盤面で行うボードゲームです。「オセロ」という名前でも親しまれています。本ゲームの対戦は、以下のルールで進行します。</p>
        <ul>
            <li>ゲーム開始時は中央に黒と白の石が 2 個ずつ配置されます。</li>
            <li>黒が先手、白が後手で交互に手を打ちます。</li>
            <li>相手の石を挟むと、自分の石に変わります。縦・横・斜めのどの方向でも挟むことができます</li>
            <li>自分の石は、相手の石を挟んで取れる場所（ <strong>合法手</strong> ）に置くことができます。</li>
            <li>自分の <strong>【合法手】</strong> がない場合は、自動的に相手の番へ <strong>【パス】</strong> されます。両者とも <strong>【パス】</strong> になった場合はゲーム終了です。</li>
        </ul>
    
        <h3>【合法手】について</h3>
        <p>本ゲームでは、プレイヤーが打てる <strong>【合法手】</strong> を自動で判定し、視認しやすいようにハイライト表示する機能があります。この機能は設定からオフにできます</p>
    
        <h3>時間制限</h3>
        <p>ゲームのスピード感を高めるために <strong>制限時間</strong> を設定できます。最短では <strong>10秒ルール</strong> の超高速対局も可能です！</p>
    
        <h3>勝利条件</h3>
        <ul>
            <li>ゲーム終了時に、自分の石の数が相手より多ければ勝利となります。同数の場合は引き分けです。</li>
            <li><strong>制限時間</strong> のある対局では、相手が時間切れになった場合も勝利となります</li>
            <li><a href="https://reversi.yuki-lab.com/online/">通信対戦</a> では、<strong>投了</strong> ボタンが使えます。相手が <strong>投了</strong> した場合、自分の勝利となります</li>
        </ul>
    </section>
    <section class ="notes" id="blog">
        <h2>リバーシ（オセロ）で勝つためのコツ</h2>
        <p>本サイト・リバーシWebの開発者が執筆した<a href="https://reversi.yuki-lab.com/strategy-reversi-othello.html">こちらの記事</a> では、オセロゲームの中・上級者向け攻略法を無料で紹介しています。ぜひご覧ください</p>
    </section>
    <!-- iOS専用のインストールガイド -->
    <div id="ios-install-guide" class="install-guide">
        <div class="install-guide-content">
            <h5>「ホーム画面に追加」でもっと快適に遊べます!</h5>
            <ul>
                <li>✅️ Webアプリだからアプリ容量はほぼ0！</li>
                <li>✅️ 高速に起動して時短！</li>
                <li>✅️ オフラインでも一部遊べる！</li>
            </ul>            
        </div>
            <div class="guide-icons">
                <img src="/static/game/images/share-icon.jpg" alt="リバーシ（オセロ）を共有するボタン" class="icon">
                <span class="arrow">➡️</span>
                <img src="/static/game/images/install-guide.png" alt="リバーシ（オセロ）を無料でホーム画面に追加" id="install-guide-img" loading="lazy">
            </div>
            <button id="close-install-guide">✖️ 閉じる</button>
        
    </div>

    <div class="credit">
            <!--copyright-->
            © 2024~ Yuki-Lab |
            本ゲームでは、多くの人にとって読みやすいユニバーサルデザインフォントを使用しています
    </div>
</div>

    <audio id="victorySound" src="{% static 'game/sounds/victory.mp3' %}" preload="auto"></audio>
    <audio id="defeatSound" src="{% static 'game/sounds/defeat.mp3' %}" preload="auto"></audio>
    <audio id="warningSound" src="{% static 'game/sounds/warning.mp3' %}" preload="auto"></audio>
    <audio id="playerJoin" src="{% static 'game/sounds/playerJoin.mp3' %}" preload="auto"></audio>
</body>

<script nonce="{{ request.csp_nonce }}" >
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register("{% static 'game/sw.js' %}")
        .then(registration => console.log("Service Worker registered:", registration))
        .catch(error => console.log("Service Worker registration failed:", error));
    }
</script>
</html>